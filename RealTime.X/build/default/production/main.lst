MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001         PROCESSOR 16F877A
2007   3731           00002         __CONFIG 0x3731 ; Clock = XT 4MHz, standard fuse settings
                      00003         INCLUDE "P16F877A.INC"
                      00001         LIST
                      00002 ; P16F877A.INC  Standard Header File, Version 1.00    Microchip Technology, Inc.
                      00398         LIST
                      00004 
                      00005 
                      00006 ; ----------- Data Area -----------
                      00007 
  00000004            00008 LCD_RS_PIN      EQU 4           ; Register select output bit
  00000005            00009 LCD_E_PIN       EQU 5           ; Enable display input
                      00010 
                      00011 ;       Uses GPR 70 - 75 for LCD Data
  00000070            00012 Timer1  EQU 0x70                ; 1ms count register
  00000071            00013 TimerX  EQU 0x71                ; Xms count register
  00000072            00014 Var     EQU 0x72                ; Output variable
  00000073            00015 Point   EQU 0x73                ; Program table pointer
  00000075            00016 TEMP    EQU 0x75                ; Temp store for output code
                      00017 
                      00018 
  00000020            00019 counter EQU 0x20        ; Counter register
  00000021            00020 counterBlink    EQU 0x21; counter FOR Blinking register
                      00021 
  00000022            00022 LCD_CSR EQU 0x22; LCD_CSR register
  000000C0            00023 Location        EQU 0xC0; counter for LCD_CSR
  00000050            00024 blinkDelay      EQU 0x50; Delay time for cursor blink :can be adjusted as needed
                      00025 
  0000007C            00026 CSR_LOC         EQU D'124'      ; CSR_LOC: "  |  "
  00000020            00027 WHITE           EQU D'32'       ; WHITE space character
                      00028 
  00000041            00029 ACHAR           EQU     D'65'; A
  00000041            00030 ACHAR           EQU     D'65'; A
  00000023            00031 currentCharReg  EQU     0x23;
                      00032 
                      00033 
                      00034 ; ---------------------------------
                      00035 ; ----------- Code Area -----------
                      00036 ; ---------------------------------
                      00037 
                      00038     ORG 0x0000          ; Start of program memory
0000   0000           00039     NOP                 ; For ICD mode
0001   2???           00040     GOTO start_exec
                      00041 
                      00042 
0002                  00043 start_exec
                      00044 
                      00045    
                      00046 
0002   1683 1303      00047         BANKSEL TRISC
0004   3000           00048         MOVLW   0x00            ; In order to set PORTC Direction to output
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0005   0087           00049         MOVWF   TRISC
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00050 
0006   1683 1303      00051         BANKSEL ADCON1
0008   3006           00052         MOVLW   0x06            ; Disable A/D Conversion
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0009   009F           00053         MOVWF   ADCON1
                      00054 
000A   1683 1303      00055         BANKSEL CMCON 
000C   3007           00056         MOVLW   0x07            ; Disable Comparator
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000D   009C           00057         MOVWF   CMCON
                      00058 
000E   3005           00059         MOVLW   0x5             ; Load initial value of 5 into W
000F   00A0           00060         MOVWF   counter         ; Store the value in the counter register
                      00061 
0010   30C0           00062         MOVLW   Location        ; Load initial value of Location into W
0011   00A2           00063         MOVWF   LCD_CSR ; Store the value in the LCD_CSR register
                      00064 
0012   3041           00065         MOVLW   ACHAR           ; Load initial value of char 'A' To W
0013   00A3           00066         MOVWF   currentCharReg  ; Store the value in the currentCharReg register
                      00067     
                      00068 
                      00069 
                      00070 ; Initialise Timer0 for push button
                      00071 
0014   1683 1303      00072         BANKSEL OPTION_REG
                      00073 
0016   30D8           00074         MOVLW   b'11011000'     ; TMR0 initialisation code
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0017   0081           00075         MOVWF   OPTION_REG              ; Int clock, no prescale        
                      00076         
                      00077     ; this is causing everything to crash
                      00078         ; BANKSEL       INTCON          ; select bank 0
                      00079         ; MOVLW b'10100000'     ; INTCON init. code
                      00080         ; MOVWF INTCON          ; Enable TMR0 interrupt
                      00081 
                      00082         
                      00083 
                      00084 
                      00085 
                      00086 ; Port & display setup
0018   1683 1303      00087         BANKSEL TRISD ; select bank 1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001A   0188           00088         CLRF TRISD ; Port D as output to LCD
                      00089 
001B   1283 1303      00090         BANKSEL PORTD ; select bank 0
001D   0188           00091         CLRF PORTD ; Clear display outputs
                      00092 
                      00093 
                      00094         
                      00095 
                      00096 ;Port B defaults to inputs for the push button :using pin 1
                      00097 
001E   2???           00098         CALL    SETUP_LCD ; Initialise the display FOR LCD
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001F   2???           00099         CALL    PUTEnterStringOnLCD
0020   2???           00100         CALL LABEL_REACH ; announce reaching this line
                      00101 
                      00102 
                      00103 
                      00104 
                      00105 ; Main loop of 5 iterations
0021                  00106 MAIN
0021   0BA0           00107         DECFSZ  counter, F      ; Decrement the counter register and skip next instruction if non-zero
0022   2???           00108         CALL    LOOPTOLOCATION  ; Loop senario
0023   0820           00109         MOVF    counter, W      ; Load the value of the file register counter into the W register
0024   1903           00110         BTFSC   STATUS, Z
0025   2???           00111         CALL    MovingSTRING    
                      00112         ;GOTO   MAIN            ; Loop back if the value is non-zero
0026   2???           00113         GOTO    DONE                    ; End of program
                      00114 
0027                  00115 MovingSTRING
0027   3080           00116         MOVLW 0x80    ; move cursor to first line, first column
0028   390F           00117         ANDLW 0x0F ; Mask the lower 4 bits
0029   1903           00118         BTFSC STATUS, Z ; If the lower 4 bits are 0, skip the next instruction
002A   2???           00119         CALL MOVELEFTONLCD ; If the lower 4 bits are not 0, call the MOVELEFTONLCD routine
002B   2???           00120         CALL MOVERIGHTONLCD ; Call the MOVERIGHTONLCD routine
                      00121 
002C                  00122 ENDMOVING       
002C   3005           00123         MOVLW   D'5'            ; Load 5 into W
002D   00A0           00124         MOVWF   counter         ; Store the value 5 to the counter register to start again
002E   2???           00125         CALL    PUTEnterStringOnLCD
                      00126 
                      00127 ; used to announce reaching a section of the code
002F                  00128 LABEL_REACH
                      00129 
002F   1283 1303      00130     BANKSEL PORTC
                      00131     
0031   3080           00132         MOVLW   0x80 ; set delay loop to 60 iterations
                      00133 
0032   1407           00134         BSF PORTC,0
0033   2???           00135         CALL DELAY_W
0034   1487           00136         BSF PORTC,1
0035   2???           00137         CALL DELAY_W
0036   1507           00138         BSF PORTC,2
0037   2???           00139         CALL DELAY_W
0038   1587           00140         BSF PORTC,3
0039   2???           00141         CALL DELAY_W
                      00142 
003A   30FF           00143         MOVLW   0xFF ; set delay loop to 255 iteration
                      00144 
003B   2???           00145         CALL DELAY_W
                      00146 
003C   1007           00147         BCF PORTC,0
003D   1087           00148         BCF PORTC,1
003E   1107           00149         BCF PORTC,2
003F   1187           00150         BCF PORTC,3
                      00151 
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0040   2???           00152         CALL DELAY_W
                      00153 
0041   2???           00154         GOTO LABEL_REACH ; loop for ever
                      00155 
                      00156 ; 200 instructions delay
0042                  00157 DELAY_W 
0042   00F5           00158         MOVWF   TEMP
0043   0000           00159 loop_start      NOP
Message[305]: Using default destination of 1 (file).
0044   0BF5           00160                 DECFSZ  TEMP
0045   2???           00161                 GOTO    loop_start
0046   0008           00162                 RETURN
                      00163 
0047                  00164 MOVERIGHTONLCD
0047   1608           00165         BSF PORTD,LCD_RS_PIN ; Set to data mode
0048   0822           00166         MOVF LCD_CSR, W ; Load the current position into the W register
0049   07F3           00167         ADDWF Point, F ; Calculate the address of the character to be shifted
004A   0873           00168         MOVF Point, W ; Load the address of the character to be shifted into the W register
                      00169         ; CALL read ; Read the value at that address
004B   00F5           00170         MOVWF TEMP ; Store the value in TEMP
004C   1208           00171         BCF PORTD,LCD_RS_PIN ; Set to command mode
004D   3014           00172         MOVLW 0x14 ; Move cursor one position to the right
004E   07A2           00173         ADDWF LCD_CSR, F ; Update the cursor position
004F   3080           00174         MOVLW 0x80 ; Move cursor to the second row, first column
0050   0722           00175         ADDWF LCD_CSR, W ; Calculate the address of the second row, first column
0051   00F3           00176         MOVWF Point ; Store the address in Point
0052   1608           00177         BSF PORTD,LCD_RS_PIN ; Set to data mode
0053   0875           00178         MOVF TEMP, W ; Load the value stored in TEMP into the W register
0054   2???           00179         CALL PulseWriteCharToLCD ; Output the value to the display
0055   1208           00180         BCF PORTD,LCD_RS_PIN ; Set to command mode
0056   3010           00181         MOVLW 0x10 ; Move cursor one position to the right
0057   07A2           00182         ADDWF LCD_CSR, F ; Update the cursor position
0058   0008           00183         RETURN ; Return to the calling routine
                      00184 
                      00185 
0059                  00186 MOVELEFTONLCD
0059   1608           00187         BSF PORTD,LCD_RS_PIN ; Set to data mode
005A   0822           00188         MOVF LCD_CSR, W ; Load the current position into the W register
005B   07F3           00189         ADDWF Point, F ; Calculate the address of the character to be shifted
005C   0873           00190         MOVF Point, W ; Load the address of the character to be shifted into the W register
                      00191         ; CALL read ; Read the value at that address
005D   00F5           00192         MOVWF TEMP ; Store the value in TEMP
005E   1208           00193         BCF PORTD,LCD_RS_PIN ; Set to command mode
005F   3010           00194         MOVLW 0x10 ; Move cursor one position to the left
0060   07A2           00195         ADDWF LCD_CSR, F ; Update the cursor position
0061   3080           00196         MOVLW 0x80 ; Move cursor to the second row, first column
0062   0722           00197         ADDWF LCD_CSR, W ; Calculate the address of the second row, first column
0063   00F3           00198         MOVWF Point ; Store the address in Point
0064   1608           00199         BSF PORTD,LCD_RS_PIN ; Set to data mode
0065   0875           00200         MOVF TEMP, W ; Load the value stored in TEMP into the W register
0066   2???           00201         CALL PulseWriteCharToLCD ; Output the value to the display
0067   1208           00202         BCF PORTD,LCD_RS_PIN ; Set to command mode
0068   3014           00203         MOVLW 0x14 ; Move cursor one position to the left
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0069   07A2           00204         ADDWF LCD_CSR, F ; Update the cursor position
006A   0008           00205         RETURN ; Return to the calling routine
                      00206 
                      00207 
006B                  00208 PUTEnterStringOnLCD 
                      00209 
006B   3080           00210         MOVLW   0x80            ; move cursor to first line, first column
006C   2???           00211         CALL    PulseWriteCmdToLCD ; send command
                      00212 
006D   3045           00213         MOVLW 'E';
006E   2???           00214         CALL PulseWriteCharToLCD;
                      00215 
006F   306E           00216         MOVLW 'n';
0070   2???           00217         CALL PulseWriteCharToLCD;
                      00218 
0071   3074           00219         MOVLW 't';
0072   2???           00220         CALL PulseWriteCharToLCD;
                      00221 
0073   3065           00222         MOVLW 'e'; 
0074   2???           00223         CALL PulseWriteCharToLCD;
                      00224 
0075   3072           00225         MOVLW 'r';
0076   2???           00226         CALL PulseWriteCharToLCD;
                      00227 
0077   3020           00228         MOVLW ' ';
0078   2???           00229         CALL PulseWriteCharToLCD;
                      00230 
0079   3053           00231         MOVLW 'S';
007A   2???           00232         CALL PulseWriteCharToLCD;
                      00233 
007B   3074           00234         MOVLW 't';
007C   2???           00235         CALL PulseWriteCharToLCD;
                      00236 
007D   3072           00237         MOVLW 'r';
007E   2???           00238         CALL PulseWriteCharToLCD;
                      00239 
007F   3069           00240         MOVLW 'i';
0080   2???           00241         CALL PulseWriteCharToLCD;
                      00242 
0081   306E           00243         MOVLW 'n'; 
0082   2???           00244         CALL PulseWriteCharToLCD;
                      00245 
0083   3067           00246         MOVLW 'g';
0084   2???           00247         CALL PulseWriteCharToLCD;
                      00248 
0085   303A           00249         MOVLW ':';
0086   2???           00250         CALL PulseWriteCharToLCD;
                      00251 
0087   0008           00252         RETURN
                      00253         
                      00254         
                      00255 
                      00256 
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00257 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Start Loop senario;;
                            ;;;;;;;;;;;;;;;;;;;;;;;;;
0088                  00258 LOOPTOLOCATION
0088   2???           00259         CALL    BLINK           ;  blinking the cursor at the Location to Write before pushing the butto
                            n 
0089   2???           00260         CALL    LOOPtoIndex     ; changing the char
008A   0AA2           00261         INCF    LCD_CSR, F
008B   0008           00262         RETURN
                      00263 
008C                  00264 LOOPtoIndex
008C   2???           00265         CALL    PINSTABLE
008D   2???           00266         CALL    waitINT
008E   2???           00267         CALL    IsReleased
008F   1208           00268         BCF     PORTD,LCD_RS_PIN        ; command mode
0090   00A2           00269         MOVWF   LCD_CSR ; selection Location
0091   2???           00270         CALL    PulseWriteCmdToLCD ; send command 
0092   1608           00271         BSF     PORTD,LCD_RS_PIN        ; data mode
0093   0823           00272         MOVF currentCharReg, W  ;Write char A on W
0094   2???           00273         CALL    PulseWriteCharToLCD             ; send Data
0095   2???           00274         CALL    TIMER2S
0096   2???           00275         CALL    WaitButton      ;Increment when button pressed
0097   0008           00276         RETURN
                      00277         
0098                  00278 TIMER2S 
0098   304E           00279         MOVLW D'78' ; Count for 250ms delay
0099   0091           00280         MOVWF TMR2 ; Load count
009A   0008           00281         RETURN
                      00282 
                      00283 
009B                  00284 WaitButton
                      00285         
009B                  00286 LOOPTOLOCATION1
009B   30F9           00287     MOVLW D'249' ; Count for 1ms delay
009C   00F0           00288         MOVWF Timer1 ; Load count
009D   0000           00289 LOOP1 NOP ; Pad for 4 cycle loop
009E   1C86           00290         BTFSS   PORTB,1         ; Test button
009F   2???           00291         GOTO    PRESED  
Message[305]: Using default destination of 1 (file).
00A0   0BF0           00292         DECFSZ Timer1 ; Count
00A1   2???           00293         GOTO LOOP1 ; until Z
Message[305]: Using default destination of 1 (file).
00A2   0B91           00294         DECFSZ TMR2 ; Count for 250ms
00A3   2???           00295         GOTO LOOPTOLOCATION1 ; until Z
                      00296 
00A4                  00297 CheakForWhitSpaceToEndString
00A4   0823           00298         MOVF    currentCharReg, W; Move the contents of currentCharReg to W
00A5   3C20           00299         SUBLW   ' ' ; Subtract the value of ASCII space from w
00A6   1903           00300         BTFSC   STATUS, Z       ; Check if the result of the comparison is zero
00A7   2???           00301         GOTO    SKIPtoNormal    ; If the contents of char is not ' ', skip the next instruction
00A8   3041           00302         MOVLW   'A'             ; Load initial value of char 'A' To W
00A9   00A3           00303         MOVWF   currentCharReg  ; Store the value in the currentCharReg register FOR the second iteratio
                            n
00AA   3001           00304         MOVLW   D'1'            ; Load 1 into W
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00AB   00A0           00305         MOVWF   counter         ; Store the value 1 to the counter register TO END
00AC   0008           00306         RETURN
                      00307         
                      00308 
00AD                  00309 SKIPtoNormal    
00AD   3041           00310         MOVLW   'A'             ; Load initial value of char 'A' To W
00AE   00A3           00311         MOVWF   currentCharReg  ; Store the value in the currentCharReg register FOR the second iteratio
                            n
00AF   0008           00312         RETURN ;  finish 2 seconds
                      00313 
00B0                  00314 PRESED  
00B0   2???           00315         CALL    PINSTABLE
00B1   2???           00316         CALL    waitINT
00B2   2???           00317         CALL    IsReleased
                      00318 
00B3                  00319 INCREMENTCHAR
00B3   1208           00320         BCF     PORTD,LCD_RS_PIN        ; command mode
00B4   00A2           00321         MOVWF   LCD_CSR ; selection Location
00B5   2???           00322         CALL    PulseWriteCmdToLCD ; send command 
00B6   1608           00323         BSF     PORTD,LCD_RS_PIN        ; data mode
                      00324 
00B7                  00325 CheakForZ
00B7   0823           00326         MOVF    currentCharReg, W; Move the contents of currentCharReg to W
00B8   3C5A           00327         SUBLW   'Z' ; Subtract the value of ASCII Z from w
00B9   1903           00328         BTFSC   STATUS, Z       ; Check if the result of the comparison is zero
00BA   2???           00329         GOTO    CheakForWhitSpace; If the contents of char is not 'Z', skip the next instruction
00BB   3020           00330         MOVLW   ' '             ; Load the ASCII value of a white space into W
00BC   00A3           00331         MOVWF   currentCharReg  ; Move W into currentCharReg
00BD   2???           00332         GOTO    MOVETOLCD
                      00333 
00BE                  00334 CheakForWhitSpace
00BE   0823           00335         MOVF    currentCharReg, W; Move the contents of currentCharReg to W
00BF   3C20           00336         SUBLW   ' ' ; Compare W to the ASCII value of ' '
00C0   1903           00337         BTFSC   STATUS, Z       ; Check if the result of the comparison is zero
00C1   2???           00338         GOTO    SKIP            ; If the contents of char is not ' ', skip the next instruction
00C2   3041           00339         MOVLW   'A'             ; Load the ASCII value of 'A' into W
00C3   00A3           00340         MOVWF   currentCharReg  ; Move W into currentCharReg
00C4   2???           00341         GOTO    MOVETOLCD       
                      00342         
00C5                  00343 SKIP    
00C5   0AA3           00344         INCF currentCharReg, F  ; Increment currentCharReg
                      00345 
00C6                  00346 MOVETOLCD
00C6   0823           00347         MOVF currentCharReg, W  ; Write char on W
00C7   2???           00348         CALL    PulseWriteCharToLCD             ; send Data
00C8   2???           00349         CALL    TIMER2S         ; Old value for timer 2 to mkae 2s
00C9   2???           00350         GOTO    WaitButton      ; To Update the same location
                      00351                 
00CA                  00352 PINSTABLE       
00CA   0181           00353         CLRF    TMR0            ; Reset timer
00CB   0008           00354         RETURN
00CC                  00355 waitINT 
00CC   1D0B           00356         BTFSS   INTCON,2        ; Check for time out"INT"
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00CD   2???           00357         GOTO    waitINT         ; Wait if not
00CE   0008           00358         RETURN
00CF                  00359 IsReleased      
00CF   1C86           00360         BTFSS   PORTB,1         ; Check step button
00D0   2???           00361         GOTO    IsReleased      ; and wait until released
00D1   0008           00362         RETURN
                      00363 
00D2                  00364 PulseWriteCmdToLCD
00D2   00F5           00365         MOVWF TEMP
Message[305]: Using default destination of 1 (file).
00D3   0EF5           00366         SWAPF TEMP
00D4   0875           00367         MOVF TEMP, W
00D5   390F           00368         ANDLW 0x0f
00D6   0088           00369         MOVWF PORTD
00D7   1208           00370         BCF PORTD, LCD_RS_PIN ;Clearing the LCD_RS_PIN Register for command mode
00D8   2???           00371         call PULSE_LCD_E_PIN
                      00372         ;call onems
Message[305]: Using default destination of 1 (file).
00D9   0EF5           00373         SWAPF TEMP
00DA   0875           00374         movf TEMP, W
00DB   390F           00375         ANDLW   0x0f
00DC   0088           00376         MOVWF PORTD
00DD   1208           00377         BCF PORTD, LCD_RS_PIN ;Clearing the LCD_RS_PIN Register for command mode
00DE   2???           00378         call PULSE_LCD_E_PIN
00DF   0008           00379         RETURN
                      00380 
                      00381 ;--------------------------------------------------------------
                      00382 ;       Send a command byte in two nibbles from RB4 - RB7
                      00383 ;       Receives command in W, uses PulseE and Onems
                      00384 ;--------------------------------------------------------------
00E0                  00385 PulseWriteCharToLCD
00E0   00F5           00386     MOVWF TEMP
Message[305]: Using default destination of 1 (file).
00E1   0EF5           00387     SWAPF TEMP
00E2   0875           00388     MOVF TEMP, W
00E3   390F           00389     ANDLW 0x0F ; Clear low nybble
00E4   0088           00390     MOVWF PORTD
00E5   1608           00391     BSF PORTD, LCD_RS_PIN ; set character mode on RS
00E6   2???           00392     call PULSE_LCD_E_PIN ; clock LCD
00E7   2???           00393     call onems
Message[305]: Using default destination of 1 (file).
00E8   0EF5           00394     SWAPF TEMP
00E9   0875           00395     MOVF TEMP, W
00EA   390F           00396     ANDLW       0x0F ; Clear high nybble
00EB   0088           00397     MOVWF PORTD
00EC   1608           00398     BSF PORTD, LCD_RS_PIN 
00ED   2???           00399     call PULSE_LCD_E_PIN 
00EE   0008           00400     RETURN
                      00401         
                      00402 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;End Loop senario;;;;;;
                            ;;;;;;;;;;;;;;;;;;;;;;;;
                      00403 
                      00404 
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00405 
                      00406 ;;;;;;;;;;;;;;;;Add blinking Delay ;;;;;;;;;;;;;;;;;;;;;;;;;;
00EF                  00407 BLINK
00EF   3050           00408         MOVLW   blinkDelay      ; Load the delay value into W
00F0   2???           00409         CALL    DELAY           ; Wait for the delay time to pass
00F1   1C86           00410         BTFSS   PORTB,1         ; Double cheak  button
00F2   0008           00411         RETURN                  ;
                      00412 
00F3   1208           00413         BCF     PORTD,LCD_RS_PIN        ; command mode
00F4   00A2           00414         MOVWF   LCD_CSR ; selection Location
00F5   2???           00415         CALL    PulseWriteCmdToLCD ; send command 
00F6   1608           00416         BSF     PORTD,LCD_RS_PIN        ; data mode
00F7   307C           00417         MOVLW   CSR_LOC         ; |
00F8   2???           00418         CALL    PulseWriteCmdToLCD              ; send CSR_LOC
                      00419         
                      00420 
00F9   3050           00421         MOVLW   blinkDelay      ; Load the delay value into W
00FA   2???           00422         CALL    DELAY           ; Wait for the delay time to pass
00FB   1C86           00423         BTFSS   PORTB,1         ; Double cheak  button
00FC   0008           00424         RETURN                  ;
                      00425 
00FD   1208           00426         BCF     PORTD,LCD_RS_PIN        ; command mode
00FE   00A2           00427         MOVWF   LCD_CSR ; selection Location
00FF   2???           00428         CALL    PulseWriteCmdToLCD ; send command 
0100   1608           00429         BSF     PORTD,LCD_RS_PIN        ; data mode
0101   3020           00430         MOVLW   WHITE           ; 
0102   2???           00431         CALL    PulseWriteCmdToLCD              ; WHITE
0103   1886           00432         BTFSC   PORTB,1         ; Test button
0104   2???           00433         GOTO    BLINK           ; Loop back
0105   0008           00434         RETURN                  ; counterBlinking to Zero when clicking the button
                      00435 
0106                  00436 DELAY
0106   00A1           00437         MOVWF   counterBlink    ; Store the delay value in the counter register
0107                  00438 DELAY_LOOP
0107   1C86           00439         BTFSS   PORTB,1         ; Double cheak  button
0108   0008           00440         RETURN                  ;
0109   0BA1           00441         DECFSZ  counterBlink, F ; Decrement the counter and skip next instruction if non-zero
010A   2???           00442         GOTO    DELAY_LOOP      ; Loop back if counter is non-zero      
010B   0008           00443         RETURN                  ; Return to main program
                      00444 ;;;;;;;;;;;;;;;;End blinking Delay ;;;;;;;;;;;;;;;;;;;;;;;;;; 
                      00445 
                      00446 
                      00447 ;--------------------------------------------------------------Start LCD CODE---------------------------
                            -------
                      00448 ;       1ms delay with 1us instruction time (1000 cycles)
                      00449 ;--------------------------------------------------------------
010C   30F9           00450 onems   MOVLW   D'249'          ; Count for 1ms delay 
010D   00F0           00451         MOVWF   Timer1          ; Load count
010E   0000           00452 LP      NOP                     ; Pad for 4 cycle loop
Message[305]: Using default destination of 1 (file).
010F   0BF0           00453         DECFSZ  Timer1          ; Count
0110   2???           00454         GOTO    LP              ; until Z
0111   0008           00455         RETURN                  ; and finish
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00456 
                      00457 ;--------------------------------------------------------------
                      00458 ;       Generate data/command clock siganl E
                      00459 ;--------------------------------------------------------------
0112   1688           00460 PULSE_LCD_E_PIN BSF     PORTD, LCD_E_PIN                ; Set E high
0113   2???           00461         CALL    onems           ; Delay 1ms
0114   1288           00462         BCF     PORTD, LCD_E_PIN                ; Reset E low
0115   2???           00463         CALL    onems           ; Delay 1ms
0116   0008           00464         RETURN                  ; done
                      00465 
                      00466 
                      00467 ;--------------------------------------------------------------
                      00468 ;       Initialise the display
                      00469 ;--------------------------------------------------------------
0117                  00470 SETUP_LCD       
                      00471 
                      00472         
                      00473 
0117   0188           00474         CLRF    PORTD           ; and output it to display
                      00475 
0118   3040           00476         MOVLW   0x40            ; wait for display start
0119   2???           00477         CALL    DELAY_W
                      00478         
                      00479         
011A   3002           00480         MOVLW   0x02    ; Set 4-bit mode
011B   2???           00481         CALL    PulseWriteCmdToLCD ; send command
                      00482         
011C   3028           00483         MOVLW   0x28            ; Set 5 by 7 mode
011D   2???           00484         CALL    PulseWriteCmdToLCD ; send command
                      00485 
                      00486         ; TODO remove
                      00487         ; MOVLW 0x08            ; Switch off display
                      00488         ; CALL  PulseWriteCmdToLCD ; send command
                      00489 
011E   3001           00490         MOVLW   0x01            ; Code to clear display
011F   2???           00491         CALL    PulseWriteCmdToLCD ; send command
                      00492 
0120   300E           00493         MOVLW   0x0E            ; Display ON and cursor blinking
0121   2???           00494     CALL        PulseWriteCmdToLCD      ; send command
                      00495 
                      00496         ; MOVLW 0x06            ; Enable cursor auto inc  
                      00497         ; CALL  PulseWriteCmdToLCD ; send command
                      00498 
0122   3080           00499         MOVLW   0x80            ; move cursor to first line, first column
0123   2???           00500         CALL    PulseWriteCmdToLCD ; send command
                      00501 
0124   300C           00502         MOVLW   0x0C            ; Turn on display  
0125   2???           00503         CALL    PulseWriteCmdToLCD ; send command
                      00504 
0126   0008           00505         RETURN                  ; Done
                      00506 
                      00507 ;--------------------------------------------------------------End LCD CODE-----------------------------
                            --------
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0127                  00508 DONE
3731                  00509         END
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE 12


SYMBOL TABLE
  LABEL                             VALUE 

ACHAR                             00000041
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BLINK                             000000EF
BRGH                              00000002
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CIS                               00000003
CKE                               00000006
CKP                               00000004
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE 13


SYMBOL TABLE
  LABEL                             VALUE 

CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             0000009C
CMIE                              00000006
CMIF                              00000006
CREN                              00000004
CSRC                              00000007
CSR_LOC                           0000007C
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            0000009D
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
CheakForWhitSpace                 000000BE
CheakForWhitSpaceToEndString      000000A4
CheakForZ                         000000B7
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DELAY                             00000106
DELAY_LOOP                        00000107
DELAY_W                           00000042
DONE                              00000127
D_A                               00000005
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
ENDMOVING                         0000002C
F                                 00000001
FERR                              00000002
FSR                               00000004
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INCREMENTCHAR                     000000B3
INDF                              00000000
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE 14


SYMBOL TABLE
  LABEL                             VALUE 

INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
IsReleased                        000000CF
LABEL_REACH                       0000002F
LCD_CSR                           00000022
LCD_E_PIN                         00000005
LCD_RS_PIN                        00000004
LOOP1                             0000009D
LOOPTOLOCATION                    00000088
LOOPTOLOCATION1                   0000009B
LOOPtoIndex                       0000008C
LP                                0000010E
Location                          000000C0
MAIN                              00000021
MOVELEFTONLCD                     00000059
MOVERIGHTONLCD                    00000047
MOVETOLCD                         000000C6
MovingSTRING                      00000027
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PINSTABLE                         000000CA
PIR1                              0000000C
PIR2                              0000000D
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE 15


SYMBOL TABLE
  LABEL                             VALUE 

PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PRESED                            000000B0
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
PULSE_LCD_E_PIN                   00000112
PUTEnterStringOnLCD               0000006B
Point                             00000073
PulseWriteCharToLCD               000000E0
PulseWriteCmdToLCD                000000D2
R                                 00000002
RBIE                              00000003
RBIF                              00000000
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
READ_WRITE                        00000002
RP0                               00000005
RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_W                               00000002
S                                 00000003
SEN                               00000000
SETUP_LCD                         00000117
SKIP                              000000C5
SKIPtoNormal                      000000AD
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE 16


SYMBOL TABLE
  LABEL                             VALUE 

SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TEMP                              00000075
TIMER2S                           00000098
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISB                             00000086
TRISC                             00000087
TRISD                             00000088
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE 17


SYMBOL TABLE
  LABEL                             VALUE 

TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
Timer1                            00000070
TimerX                            00000071
UA                                00000001
Var                               00000072
W                                 00000000
WCOL                              00000007
WHITE                             00000020
WR                                00000001
WREN                              00000002
WRERR                             00000003
WaitButton                        0000009B
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00001FFF
_CP_OFF                           00003FFF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_HS_OSC                           00003FFE
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_1FOURTH                      00003BFF
_WRT_256                          00003DFF
_WRT_HALF                         000039FF
_WRT_OFF                          00003FFF
_XT_OSC                           00003FFD
__16F877A                         00000001
blinkDelay                        00000050
counter                           00000020
counterBlink                      00000021
currentCharReg                    00000023
loop_start                        00000043
onems                             0000010C
start_exec                        00000002
waitINT                           000000CC

MPASM 5.87                          MAIN.ASM   2-12-2023  17:25:01         PAGE 18





Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    13 reported,     0 suppressed

